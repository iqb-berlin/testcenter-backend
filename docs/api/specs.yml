openapi: 3.0.0
info:
    title: ""
    description: 'This a spec for the (REST-) API of the IQB-Testcenter Application. It will be used to make backend''s e2e-test and a mock-server for frontend''s e2e-tests. It''s the basis for our vision of continuous integration.'
    version: 12.2.0
paths:
    '/booklet/{booklet_name}':
        get:
            summary: 'get a booklet'
            description: 'Retrieves a Booklet-XML'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user containing a personToken'
                    example: 'p:user000000000.test0000000'
                -
                    in: path
                    name: booklet_name
                    description: 'id of a executed test'
                    example: BOOKLET.SAMPLE-1
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'A Booklet-XML (see: https://github.com/iqb-berlin/testcenter-backend/blob/master/definitions/vo_Booklet.xsd)'
                    content:
                        application/xml:
                            example: '<?xml version="1.0" encoding="utf-8"?><Booklet...'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/booklet/{booklet_name}/data':
        get:
            summary: 'get status of a booklet'
            description: 'Retrieves a booklet - in this context that does not mean the booklet-file''s content but status information about this booklet in regard of a given login: Is there a running test for this booklet etc.'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user containing a personToken'
                    example: 'p:user000000000.test0000000'
                -
                    in: path
                    name: booklet_name
                    description: 'id of a executed test'
                    example: BOOKLET.SAMPLE-1
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'an object containing information about booklet'
                    content:
                        application/json:
                            example:
                                running: true
                                locked: false
                                label: 'Booklet''s little label'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/monitor/group/{group_name}':
        get:
            summary: 'get a group'
            description: 'Retrieves Information about a (testtakers-)group. It has to be in the same workspace as the requesting user, who has to have in mode `monitor-group`.'
            tags:
                - 'run monitor'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for group-monitor'
                    example: 'g:user000000000.0000000000'
                -
                    in: path
                    name: group_name
                    description: 'name (id) of a group'
                    example: sample_group
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'return group data'
                    content:
                        application/json:
                            example:
                                label: 'Primary Sample Group'
                                name: sample_group
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '404':
                    description: 'Group not found'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /monitor/test-sessions:
        get:
            summary: 'get TestSessions of a group'
            description: 'Retrieves all running test sessions from group of a group-monitor. Returns also an URL to a websocket to subscribe to this information if available. Sessions for Persons of this group which are not created right now get created.'
            tags:
                - 'run monitor'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for group-monitor'
                    example: 'g:user000000000.0000000000'
            responses:
                '200':
                    description: 'return group data'
                    content:
                        application/json:
                            example:
                                -
                                    personId: 1
                                    groupName: sample_group
                                    personLabel: test/xxx
                                    groupLabel: 'Sample group'
                                    mode: run-hot-return
                                    testId: 1
                                    testState: {CURRENT_UNIT_ID: '1'}
                                    bookletName: BOOKLET.SAMPLE-1
                                    unitName: UNIT.SAMPLE
                                    unitState: {PRESENTATIONCOMPLETE: yes}
                                    timestamp: 1596455898
                                -
                                    personId: 1
                                    groupName: sample_group
                                    personLabel: test/xxx
                                    groupLabel: 'Sample group'
                                    mode: run-hot-return
                                    testId: '2,'
                                    testState: {status: locked}
                                    bookletName: BOOKLET.SAMPLE-2
                                    unitState: []
                                    timestamp: 1606736826
                                -
                                    personId: 3
                                    groupName: sample_group
                                    personLabel: test-group-monitor
                                    groupLabel: 'Sample group'
                                    mode: monitor-group
                                    testId: -1
                                    testState: []
                                    unitState: []
                                    timestamp: 1596455898
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /monitor/command:
        put:
            summary: 'send command'
            description: 'Send a monitor command to a set of running tests'
            tags:
                - 'run monitor'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for group-monitor'
                    example: 'g:user000000000.0000000000'
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                keyword:
                                    type: string
                                arguments:
                                    type: array
                                    items: {type: string}
                                timestamp:
                                    type: number
                                    description: 'when the command was given'
                                testIds:
                                    items: {type: integer}
                        example:
                            keyword: MY-COMMAND
                            arguments:
                                - arg1
                                - arg2
                            timestamp: 1597906980
                            testIds:
                                - 1
            responses:
                '201':
                    description: 'command sent'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/monitor/group/{group_name}/tests/unlock':
        post:
            summary: 'unlock a bunch of tests'
            description: 'Unlocks a bunch of running tests'
            tags:
                - 'run monitor'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for group-monitor'
                    example: 'g:user000000000.0000000000'
                -
                    in: path
                    name: group_name
                    description: 'name (id) of a group'
                    example: sample_group
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            type: array
                            items:
                                type: number
                        example:
                            - 2
            responses:
                '200':
                    description: 'tests unlocked'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/monitor/group/{group_name}/tests/lock':
        post:
            summary: 'Lock a bunch of tests'
            description: 'Locks a bunch of running tests'
            tags:
                - 'run monitor'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for group-monitor'
                    example: 'g:user000000000.0000000000'
                -
                    in: path
                    name: group_name
                    description: 'name (id) of a group'
                    example: sample_group
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            type: array
                            items:
                                type: number
                        example:
                            - 2
            responses:
                '200':
                    description: 'tests unlocked'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /session:
        get:
            summary: 'get a session'
            description: 'returns session data according to an authToken.'
            tags:
                - 'session management'
            parameters:
                -
                    in: header
                    name: AuthToken
                    examples:
                        personToken:
                            description: 'auth-token for person'
                            value: 'p:0000000000000.00000000000'
                        loginToken:
                            description: 'auth-token for login (part I of 2-factor authorization only)'
                            value: 'l:user000000000.test0000000'
                        adminToken:
                            description: 'auth-token for admin'
                            value: 'a:user000000000.rw00000000'
            responses:
                '200':
                    description: 'OK, get session data'
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/session'
                            examples:
                                personToken:
                                    value: {token: 'static:person:sample_group_test_xxx', displayName: sample_group/test/xxx, access: {test: [BOOKLET.SAMPLE-1]}, customTexts: {}, flags: []}
                                loginToken:
                                    value: {token: 'static:login:test', displayName: sample_group/test, access: {}, customTexts: {}, flags: [codeRequired]}
                                adminToken:
                                    value: {token: 'static:admin:super', displayName: super, access: {superAdmin: []}, customTexts: {}, flags: []}
                '401':
                    description: 'No token qualifies for authentication'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /session/admin:
        put:
            summary: 'Start Admin Session'
            description: 'Starts a Session as Admin by Username and password'
            tags:
                - 'session management'
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/login_request'
            responses:
                '200':
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/session'
                            example:
                                token: user000000000.0000000000
                                displayName: super
                                access:
                                    workspaceAdmin: [1]
                                    superAdmin: []
                '202':
                    description: 'User has account but neither workspace nor super-admin privilige'
                '400':
                    description: 'Insufficent Crendetials'
                '500':
                    description: 'Server Error'
    /session/login:
        put:
            summary: 'Start Login Session'
            description: 'Starts a Session as Login to run a test by Username and password If the login requires a subsequent code insertion, you get a session with no access and the request for a password. Otherwise a set of accessible booklets will be retrieved.'
            tags:
                - 'session management'
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/login_request'
                        example:
                            name: test
                            password: user123
            responses:
                '200':
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/session'
                            example:
                                token: static_login_sample_login
                                displayName: sample_group/test
                                access: {}
                                customTexts: {}
                                flags:
                                    - codeRequired
                '400':
                    description: 'Insufficent Crendetials'
                '500':
                    description: 'Server Error'
    /session/person:
        put:
            summary: 'Start Person Session'
            description: 'Starts a Session for a Person to run a test, on the basis of LoginToken (!) which is Part II of the Two-Factor Authentication for code-requiring logins. Get a token for a person belonging to a login, as defined in a `Testtakers.xml`-file, together with some information about this person'
            tags:
                - 'session management'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for a login-session'
                    example: 'l:user000000000.test0000000'
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                code:
                                    type: string
                        example:
                            code: xxx
            responses:
                '200':
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/session'
                            example:
                                token: static_person_xxx
                                displayName: sample_group/test/xxx
                                access:
                                    test: ['- BOOKLET.SAMPLE-1']
                                customTexts: {}
                                flags: []
                '400':
                    description: 'Insufficent Crendetials'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/speed-test/random-package/{size}':
        get:
            summary: 'download speedtest package'
            description: 'returns a random byte package - for speedtests in system-check'
            tags:
                - 'run system check'
            parameters:
                -
                    in: path
                    name: size
                    description: 'number of bytes to bedelivered - between 16 and 67108864'
                    example: 16
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'a object containg information about booklet'
                    content:
                        text/plain;charset=utf-8:
                            schema:
                                type: string
                            example: lrOI/JLFOAPBOHt=
                '406':
                    description: 'bad package size'
                '500':
                    description: 'server error'
    /speed-test/random-package:
        post:
            summary: 'upload speedtest package'
            description: 'receives any package and returns information about size and time - for speedtests in system-checks'
            tags:
                - 'run system check'
            requestBody:
                content:
                    text/plain:
                        schema:
                            type: string
                        example: '1324567890123456'
            responses:
                '200':
                    description: 'a object containg information about booklet'
                    content:
                        application/json:
                            schema:
                                type: object
                                properties:
                                    requestTime: {type: number}
                                    packageReceivedSize: {type: number, example: 16}
                '500':
                    description: 'server error'
    /list/routes:
        get:
            summary: 'Lists all available endpoints'
            tags:
                - 'api info'
            responses:
                '200':
                    description: OK
                    content:
                        application/json:
                            example:
                                - '[GET] /list/routes'
                '500':
                    description: 'Server Error'
    /system/config:
        get:
            summary: 'get system config'
            description: 'returns publicly available parts of system config - version number - customTexts for UI - information about a broadcastingService - serverTimestamp (in milliseconds)'
            tags:
                - 'api info'
                - 'super admin'
            responses:
                '200':
                    description: OK
                    content:
                        application/json:
                            schema:
                                type: object
                                properties:
                                    version: {type: string}
                                    customTexts: {type: object}
                                    appConfig: {type: object}
                                    broadcastingService: {type: object, properties: {versionExpected: {type: string}, status: {type: string}, version: {type: string}}}
                                    baseUrl: {type: string, description: 'base url of the API'}
                                required:
                                    - version
                                    - customTexts
                                    - broadcastingService
                                    - appConfig
                            example:
                                version: 12.2.0
                                customTexts: {}
                                appConfig: {}
                                broadcastingService:
                                    versionExpected: 1.0.0
                                    status: online
                                    version: 1.0.0
                '500':
                    description: 'Server Error'
    /system/config/app:
        patch:
            summary: 'Update AppConfig'
            description: 'The AppConfig is a key-values store containing instance-specific settings for the frontend analogous to the CustomTexts, except that the values could be objects as well - they would become stringyfied then.'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                        example:
                            key: 'value-pairs, values can be are'
                            whatever: 'you want'
                            maybe:
                                an: object
                            or:
                                - an
                                - array
                            even: null
            responses:
                '200':
                    description: 'successfully updated appConfig'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    /system/config/custom-texts:
        patch:
            summary: 'Update CustomTexts'
            description: 'The CustomTexts is a key-values store containing instance-specific settings for the frontend analogous to the AppConfig. The Endpoint accepts anything as value, but CustomTexts should normally only contain string-values.'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                        example:
                            key: value
                            another_key: another_value
            responses:
                '200':
                    description: 'successfully updated appConfig'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    /version:
        get:
            summary: 'get API version'
            tags:
                - 'api info'
            responses:
                '200':
                    description: OK
                    content:
                        application/json:
                            example:
                                version: 12.2.0
    /workspaces:
        get:
            summary: 'get a list of workspaces'
            description: 'get a list of all workspaces'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            responses:
                '200':
                    description: 'List of Workspaces'
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/workspace_list'
                            example:
                                -
                                    id: '1'
                                    name: example_workspace
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
        delete:
            summary: 'delete some workspaces'
            description: 'deletes a list of workspaces given by their ids'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                ws:
                                    type: array
                                    description: 'list of Workspace-Id'
                                    items: {type: integer}
                            required:
                                - ws
                        example:
                            ws:
                                - 2
            responses:
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /users:
        get:
            summary: 'get a list of users'
            description: 'returns info about all registered users.'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            responses:
                '200':
                    description: 'List of users'
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/user_list'
                            example:
                                -
                                    name: super
                                    id: '1'
                                    email: null
                                    isSuperadmin: true
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
        delete:
            summary: 'delete some users'
            description: 'deletes a list of given user-ids. ids wich did not exist get skipped; in other words there is no check if the user exists beforeheand.'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                u:
                                    type: array
                                    items: {type: string, description: user-id}
                        example:
                            u:
                                - 2
            responses:
                '200':
                    description: ok
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /sys-checks:
        get:
            summary: 'get a list of system checks'
            description: 'get a list of available SysChecks (from all workspaces)'
            tags:
                - 'run system check'
            responses:
                '200':
                    description: 'list of SysChecks'
                    content:
                        application/json:
                            schema:
                                type: array
                                items:
                                    type: object
                                    properties: {workspaceId: {type: integer}, name: {type: string}, label: {type: string}, description: {type: string}}
                            example:
                                -
                                    workspaceId: 1
                                    name: SYSCHECK.SAMPLE
                                    label: 'An example SysCheck definition'
                                    description: 'An example SysCheck definition with long description'
                '204':
                    description: 'No SysChecks found.'
                '500':
                    description: 'Server Error'
    /system/time:
        get:
            summary: 'get the server time'
            description: 'return the server''s current timestamp and timezone'
            tags:
                - 'run monitor'
            responses:
                '200':
                    description: 'list of SysChecks'
                    content:
                        application/json:
                            example:
                                timezone: Europe/Berlin
                                timestamp: 1618816319707.522
                '500':
                    description: 'Server Error'
    '/test/{test_id}':
        get:
            summary: 'get a test'
            description: "Retrieves a certain test: It's content, state and the mode of current login-session.\n`laststate` is an array of key-value-pairs stored for this test.\nThe test-mode is basically a string to be interpretated by the frontend. For more details\nabout that see: https://github.com/iqb-berlin/testcenter-frontend/blob/master/docs/test-mode.md\n  * `run-hot-return` and `run-hot-restart` - the real testing situation\n  * `run-review` - for reviewers of of units and booklets\n  * `run-trial` - for trying out the booklet\n  * `run-demo` - for showcase only\n\nFrom the backend's point of view these modes are all the same. Some have special meanings for the backend\nnevertheless:\n  * `monitor-group` is the monitor account to supervise a group of testees\n  * For `run-hot-restart` and `demo` every session is unique so the test will be restarted everytime a new session is started (eg after logout) and it will not possible to return to the previous session. Provided data from previous sessions will be stored anyway.\n  * `run-hot-return` and `run-hot-restart` - only these types of test wil be broadcasted via broadcasting service, so they can be views in the group-monitor."
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'id of a executed test'
                    example: 1
                    required: true
                    schema:
                        type: integer
            responses:
                '200':
                    description: 'Test and it''s contents'
                    content:
                        application/json:
                            example:
                                mode: run-hot-return
                                laststate:
                                    CURRENT_UNIT_ID: '1'
                                xml: '(contents of a booklet.xml)'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/unit/{unit_name}':
        get:
            summary: 'get a unit of a test'
            description: "Retrieves a certain unit for a certain executed test - the booklet-file XML, last state and lock status.\n\nYou can insert an optional parameter `/alias/{alias}` in the end to obtain data if unit is defined with\nan alias in the booklet. This is an HotFix for https://github.com/iqb-berlin/testcenter-frontend/issues/261."
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'id of a executed test'
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: path
                    name: unit_name
                    description: 'unit-name (not alias!) as defined in booklet'
                    examples:
                        externalUnitContents:
                            value: UNIT.SAMPLE
                        directUnitContents:
                            value: UNIT.SAMPLE-2
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'List of Workspaces'
                    content:
                        application/json:
                            examples:
                                externalUnitContents:
                                    value: {state: {PRESENTATIONCOMPLETE: yes}, dataParts: {all: '{"name":"Sam Sample","age":34}'}, playerId: VERONA-PLAYER-SIMPLE-4.HTML, unitStateDataType: example-data-format, definitionRef: SAMPLE_UNITCONTENTS.HTM}
                                directUnitContents:
                                    value: {state: {}, dataParts: {}, unitStateDataType: null, playerId: VERONA-PLAYER-SIMPLE-4.HTML, definition: '(content of Sample Unit 2)'}
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/resource/{resource_name}':
        get:
            summary: 'get resource by name'
            description: 'retrieves a resource-file by its name (filename without extension)'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'id of a executed test'
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: path
                    name: resource_name
                    description: 'resource_name (filename without extension in case of plaayer, else filename)'
                    example: verona-player-simple-4.0.0.html
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'The Resource'
                    content:
                        application/octet-stream:
                            example: '(HTML code containing player)'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/unit/{unit_name}/review':
        put:
            summary: 'add review to unit'
            description: 'adds a review item to unit in a test'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
                -
                    in: path
                    name: unit_name
                    description: 'unit-name (or alias) as defined in booklet'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                priority:
                                    description: 'priority, 1=critical, 2=medium, 3=optional'
                                    type: integer
                                entry:
                                    description: 'text of the review entry'
                                    type: string
                                categories:
                                    description: 'whitespace separated list of categories'
                                    type: string
                            required:
                                - entry
                        example:
                            entry: 'I am a critical review item for unit 1'
                            priority: 1
                            categories: 'content whatever'
            responses:
                '201':
                    x-dredd-test-order: 1
                    description: 'OK, created'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/review':
        put:
            summary: 'add review to booklet'
            description: 'adds a review item to a certain booklet'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                priority:
                                    description: 'priority, 1=critical, 2=medium, 3=optional'
                                    type: integer
                                entry:
                                    description: 'text of the review entry'
                                    type: string
                                categories:
                                    description: 'whitespace separated list of categories'
                                    type: string
                            required:
                                - entry
                        example:
                            entry: 'I am a critical review item for booklet 1'
                            priority: 1
                            categories: 'content whatever'
            responses:
                '201':
                    description: 'OK, created'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/unit/{unit_name}/response':
        put:
            summary: 'add response to a unit'
            description: 'when running a test this endpoint is used to store given responses. Format and content of responses are business of the corresponding player, the endpoints take everything as raw, may it be JSON or XML or whatever.'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
                -
                    in: path
                    name: unit_name
                    description: 'unit-name (or alias) as defined in booklet'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                response:
                                    description: 'response data'
                                    type: string
                                timeStamp:
                                    description: 'timestamp of the response'
                                    type: integer
                                responseType:
                                    description: 'TODO what is this?'
                                    type: string
                            required:
                                - response
                                - timeStamp
                        example:
                            response: 'I am the answers to your questions.'
                            timeStamp: 1582550888563
            responses:
                '201':
                    description: 'OK, created'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/unit/{unit_name}/state':
        patch:
            summary: 'save a state for a unit'
            description: 'Updates the state (a key-value list) of a unit in a running test with a given key-value pair. Some known state-keys are: - ''PRESENTATIONCOMPLETE'' - ''RESPONSECOMPLETE'' - ''PAGE_NR'' - ''PAGE_COUNT'' - ''PAGE_NAME'' but all strings are allowed. For more about states see - https://github.com/iqb-berlin/testcenter-frontend/blob/55b2ba599264587e0175503cae66073211c3adb1/src/app/test-controller/test-controller.interfaces.ts#L53 - https://verona-interfaces.github.io/player/#operation-subscribe-vopStateChangedNotification'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
                -
                    in: path
                    name: unit_name
                    description: 'unit-name (or alias) as defined in booklet'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/state'
                        example:
                            -
                                key: PRESENTATIONCOMPLETE
                                content: "yes\n"
                                timeStamp: 50003
                            -
                                key: SOME_OTHER_KEY
                                content: any_value
                                timeStamp: 50002
            responses:
                '200':
                    description: 'OK, updated'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/state':
        patch:
            summary: 'update state of a running test'
            description: 'Updates the state (a key-value list) of a running test with a given key-value pair. Some known state-keys are: - ''CURRENT_UNIT'' - ''CONTROLLER'' but all strings are allowed. For more about states see - https://github.com/iqb-berlin/testcenter-frontend/blob/55b2ba599264587e0175503cae66073211c3adb1/src/app/test-controller/test-controller.interfaces.ts#L53'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/state'
                        example:
                            -
                                key: CURRENT_UNIT_ID
                                content: UNIT_ID_X
                                timeStamp: 60000
                            -
                                key: CONTROLLER
                                content: PAUSED
                                timeStamp: 70000
            responses:
                '200':
                    description: 'OK, updated'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/unit/{unit_name}/log':
        put:
            summary: 'save a log-entry for a unit'
            description: 'Saves an array of log-entries for a unit in a running test. A log entry consists of a (JSON-encoded) content which is optional. Some currently used logentry key words for units are- UNITENTER, UNITTRYLEAVE, PRESENTATIONCOMPLETE, RESPONSESCOMPLETE, PAGENAVIGATIONSTART, PAGENAVIGATIONCOMPLETE.'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
                -
                    in: path
                    name: unit_name
                    description: 'unit-name (or alias) as defined in booklet'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/log_set'
                        example:
                            -
                                key: 'PAGENAVIGATIONSTART: "#first"'
                                timeStamp: 1582230020
                            -
                                key: PAGENAVIGATIONEND
                                content: '#first'
                                timeStamp: 1234596899
            responses:
                '201':
                    description: 'OK, log saved'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/log':
        put:
            summary: 'save log-entries for a running test'
            description: 'Saves an array of log-entries for a running test. A log entry consists of a (JSON-encoded) content which is optional. Some currently used logentry key words for booklets are- BOOKLETLOADSTART, BOOKLETLOADCOMPLETE, BOOKLETLOCKEDbyTESTEE.'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/log_set'
                        example:
                            -
                                key: BOOKLETLOADSTART
                                content: '{Browser:"Dredd"}'
                                timeStamp: 1582230020
            responses:
                '201':
                    description: 'OK, log saved'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    '/test/{test_id}/lock':
        patch:
            summary: 'finish a test'
            description: 'locks (finishes) a running test'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                message:
                                    description: 'message to log'
                                    type: string
                                timeStamp:
                                    description: 'timestamp of locking event'
                                    type: integer
                            required:
                                - timeStamp
                                - message
                        example:
                            timeStamp: 123456789
                            message: 'test was locked'
            responses:
                '200':
                    description: 'OK, locked'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '500':
                    description: 'Server Error'
    /test:
        put:
            summary: 'start a test'
            description: 'Creates a new test for a given person and booklet-name'
            tags:
                - 'run test'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                bookletName:
                                    description: 'name of the booklet to start'
                                    type: string
                            required:
                                - bookletName
                        example:
                            bookletName: BOOKLET.SAMPLE-1
            responses:
                '201':
                    description: 'OK, started'
                    content:
                        'text/html; charset=UTF-8':
                            example: '1'
                '401':
                    description: 'Not authenticated - auth token header is missing or not containing a login token'
                '403':
                    description: Forbidden
                '423':
                    description: 'Test is locked!'
                '500':
                    description: 'Server Error'
    '/test/{test_id}/command/{command_id}/executed':
        patch:
            summary: 'set command as executed'
            description: "When the frontend executed a command, we send back this information to Backend via this command,\nto make sure it never gets executed again."
            tags:
                - 'run test'
                - 'run monitor'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
                -
                    in: path
                    name: command_id
                    description: 'unique id of a command'
                    example: 3
                    required: true
                    schema:
                        type: number
            responses:
                '200':
                    description: 'OK, command is marked as executed (or was already set as executed before)'
                '401':
                    description: 'Not authenticated - auth token header is missing or not containing a login token'
                '403':
                    description: Forbidden
                '423':
                    description: 'Test is locked!'
                '500':
                    description: 'Server Error'
    '/test/{test_id}/commands':
        get:
            summary: 'get commands'
            description: "Returns commands from the group-monitor (test-proctor) if given. They can be polled or subscribed via websocket\nif available. The websocket address is stored in header \"SubscribeURI\"."
            tags:
                - 'run monitor'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for test-user'
                    example: 'p:0000000000000.00000000000'
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                lastCommandId:
                                    description: 'Optional. The id of a command. If given, only subsequent commands will be retrieved.'
                                    type: integer
                            required:
                                - bookletName
                        example:
                            lastCommandId: 2
            responses:
                '200':
                    description: 'list of subsequent commands'
                    content:
                        application/json:
                            schema:
                                type: array
                                items:
                                    type: object
                                    properties: {id: {type: number, description: 'a unique ID to make sure, the command get never executed twice'}, keyword: {type: string, description: 'the command-keyword. TODO - add known keywords'}, arguments: {type: array, description: 'a list of token as arguments provided with the keyword', items: {type: string}}, timeStamp: {type: number, description: 'timstamp when the command was given'}}
                            example:
                                -
                                    id: 3
                                    keyword: COMMAND
                                    arguments: [p4]
                '401':
                    description: 'Not authenticated - auth token header is missing or not containing a login token'
                '403':
                    description: Forbidden
                '423':
                    description: 'Test is locked!'
                '500':
                    description: 'Server Error'
    '/test/{test_id}/connection-lost':
        post:
            summary: 'Notify Closing Test'
            description: "A closing browser or such can use this window to notify, that a running test was closed. Because it has to\nbe called under special circumstances, it does not need any authentication."
            tags:
                - 'run test'
                - 'run monitor'
            parameters:
                -
                    in: path
                    name: test_id
                    description: 'test-id - id of a test execution.'
                    example: 1
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'OK, test was marked as disconnected'
                '404':
                    description: 'Test not found'
                '500':
                    description: 'Server Error'
    '/{auth_token}/resource/{resource_name}':
        get:
            summary: 'get resource for directDownloadUrl'
            description: 'Since Verona v4 spec, additional resources can be loaded by the unit on demand. This `directDownloadUrl`-parameter can use this endpoint wich contains the auth-token in the url, not in the header.'
            tags:
                - 'run test'
            parameters:
                -
                    in: path
                    name: auth_token
                    description: 'the (person-)auth-token which would usually be found in the header'
                    example: 'static:person:sample_group_test_xxx'
                    required: true
                    schema:
                        type: string
                -
                    in: path
                    name: resource_name
                    description: 'name/id of the resource'
                    example: SAMPLE_UNITCONTENTS.HTM
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'The resource'
                    content:
                        application/octet-stream:
                            example: '(the resource''s content)'
                '403':
                    description: Forbidden
                '404':
                    description: 'The resource was not found'
                '500':
                    description: 'Server Error'
    '/user/{user_id}/workspaces':
        get:
            summary: 'get a list of workspaces'
            description: 'get a list of all workspaces belonging to a given user'
            tags:
                - 'session management'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: user_id
                    description: user-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            responses:
                '200':
                    description: 'List of Workspaces'
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/workspace_list'
                            example:
                                -
                                    id: '1'
                                    name: example_workspace
                                    selected: false
                                    role: ""
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
        patch:
            summary: 'change user roles'
            description: 'changes user roles for a given user in several workspaces. *Provide user-name, not user-id!*'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: user_id
                    description: user-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                ws:
                                    type: array
                                    description: 'array of pairs role-id'
                                    items: {type: object, properties: {id: {type: integer, description: workspace-id}, role: {type: string, description: 'role: ''RW'', ''RO'''}}}
                            required:
                                - ws
                        example:
                            ws:
                                -
                                    role: RW
                                    id: 1
            responses:
                '200':
                    description: 'OK, roles have been updated'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /user:
        put:
            summary: 'add a user'
            description: 'adds a user'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/user'
                        example:
                            n: thirdUser
                            p: thirdUsersPassword
            responses:
                '201':
                    description: 'OK, user has been added'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/user/{user_id}/password':
        patch:
            summary: 'change user-password'
            description: 'changes the password of a given user.'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: user_id
                    description: user-id
                    example: 2
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/user'
                        example:
                            p: secondUsersNewPassword
            responses:
                '200':
                    description: 'password has changed / user did not exist'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/user/{user_id}/super-admin/{new_status}':
        patch:
            summary: 'change super-admin status'
            description: 'changes the super-admin status of a given user. * **requires a super-admin** * **requires the password of the performing user for security reasons** * `new_status` is `on` or `off`'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: user_id
                    description: user-id
                    example: 2
                    required: true
                    schema:
                        type: integer
                -
                    in: path
                    name: new_status
                    description: 'super-user status of the given user `on` or `off`'
                    example: on
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            type: object
                            properties:
                                p:
                                    type: string
                                    description: 'performing user''s password'
                                    example: user123
            responses:
                '200':
                    description: 'password has changed / user did not exist'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/file/{type}/{filename}':
        get:
            summary: 'get file'
            description: 'retrieves a file form a given workspace by filename'
            tags:
                - 'admin download'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    schema:
                        $ref: '#/components/schemas/auth'
                    example: 'a:user000000000.ro00000000'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    schema:
                        type: integer
                    required: true
                -
                    in: path
                    name: type
                    description: 'file type - Testtakers | Booklet | Resource | Unit | SysCheck - CASE SENSITIVE!'
                    example: Unit
                    required: true
                    schema:
                        type: string
                -
                    in: path
                    name: filename
                    description: 'filename. - CASE SENSITIVE!'
                    example: SAMPLE_UNIT.XML
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'File contents'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '404':
                    description: 'workspace or file not found'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/responses':
        delete:
            summary: 'delete data'
            description: 'deletes all results and monitor data of a group of groups'
            tags:
                - 'admin workspace'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role "RW" (read/write) for this workspace'
                    example: 'a:user000000000.rw00000000'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                groups:
                                    type: array
                                    description: 'array of group names'
                                    items: {type: string}
                        example:
                            groups:
                                - sample_group
            responses:
                '200':
                    description: OK
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '404':
                    description: 'workspace or file not found'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/results':
        get:
            summary: 'get results'
            description: 'retrieves a list of unit- and booklet results for a given workspace and groups'
            tags:
                - 'admin workspace'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            responses:
                '200':
                    description: 'OK, list of results'
                    content:
                        application/json:
                            schema:
                                type: array
                                items:
                                    type: object
                                    properties: {groupname: {type: string}, bookletsStarted: {type: integer}, num_units_min: {type: string}, num_units_max: {type: string}, num_units_total: {type: string}, lastchange: {type: string, description: timestamp}, num_units_mean: {type: integer}}
                            example:
                                -
                                    groupname: sample_group
                                    bookletsStarted: 1
                                    num_units_min: '1'
                                    num_units_max: '1'
                                    num_units_total: '1'
                                    lastchange: '1567776853037'
                                    num_units_mean: 1
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '404':
                    description: 'Workspace not found'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/file':
        post:
            summary: 'upload file'
            description: "Uploads a Resource, Unit, Booklet, SysCheck or Testtakers file. The File gets imported to the workspace if it\nis valid, and passes the cross-validation checks. So a file which depends of a non-existing player will get\nrejected as well as an invalid xml file.\n\nWhen a file with the same filename and type exists in the workspace, it gets overwritten! Except if the\ninternal id (the <ID>-Tag as used in Unit-files for example) of the old and the new file differs. In this case\nit's assumed, that the file-name-duplication is inintentional and the new import gets rejected.\n\nThe endpoint accepts all kinds of files. Zip-archives get extracted an treated the same as multi-file-upload."
            tags:
                - 'admin upload'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role "RW" (read/write) for this workspace'
                    example: 'a:user000000000.rw00000000'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    multipart/form-data:
                        schema:
                            type: object
                            properties:
                                fileforvo:
                                    type: string
                                    description: 'upload file'
                                    example: '(content of Unit.xml)'
                            required:
                                - fileforvo
            responses:
                '201':
                    description: 'Upload Successful'
                    content:
                        application/json:
                            example:
                                SAMPLE_UNIT.XML:
                                    warning: ['File of name `SAMPLE_UNIT.XML` did already exist and was overwritten.']
                '207':
                    description: 'Upload Successful, import of one or more files was rejected'
                    content:
                        application/json:
                            example:
                                SAMPLE_UNIT.XML:
                                    error: ['Invalid root-tag: `Invalid`']
                '400':
                    description: 'file could not be uploaded or is invalid.'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '404':
                    description: 'workspace not found'
                '410':
                    description: 'Session Expired'
                '413':
                    description: 'File too large'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/files':
        get:
            summary: 'get files of workspace'
            description: 'get a list of all files in workspace'
            tags:
                - 'admin workspace'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            responses:
                '200':
                    description: 'OK, a list of files'
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/file_list'
                            example:
                                Resource:
                                    - {name: SAMPLE_UNITCONTENTS.HTM, size: 13392, modificationTime: 1615970109, type: Resource, id: SAMPLE_UNITCONTENTS.HTM, report: [], info: []}
                                    - {name: verona-player-simple-4.0.0.html, size: 29960, modificationTime: 1615970109, type: Resource, id: VERONA-PLAYER-SIMPLE-4.0.0.HTML, report: {info: ['Verona-Version: 3.0.0']}, info: {veronaVersion: '4.0', playerId: verona-player-simple, description: 'This is a simple, dependency-less, vanilla-js-written, but full-featured unit player, mainly as showcase for developers and for software-testing. It does implement the Verona 4.0.0-Standard and can be used for units containing simple any content in HTML-format. Unit Description ist the <code>form-content as HTML. Just give some names to the form element, and the player does the rest. Use some special Ids for some special buttons.', label: 'Simple HTML Player'}}
                                Unit:
                                    - {name: SAMPLE_UNIT.XML, size: 497, modificationTime: 1615970109, type: Unit, id: UNIT.SAMPLE, report: [], info: {description: 'This is a sample unit showing the possibilities of the sample player.', label: 'A sample unit', totalSize: 13889}}
                                    - {name: SAMPLE_UNIT2.XML, size: 1737, modificationTime: 1615970109, type: Unit, id: UNIT.SAMPLE-2, report: [], info: {description: 'This is an Unit', label: 'A sample unit', totalSize: 1737}}
                                Booklet:
                                    - {name: SAMPLE_BOOKLET.XML, size: 1404, modificationTime: 1615970109, type: Booklet, id: BOOKLET.SAMPLE-1, report: [], info: {description: 'This a sample booklet for testing/development/showcase purposes.', label: 'Sample booklet', totalSize: 60879}}
                                    - {name: SAMPLE_BOOKLET2.XML, size: 564, modificationTime: 1615970109, type: Booklet, id: BOOKLET.SAMPLE-2, report: [], info: {label: 'Reduced Booklet', totalSize: 46150}}
                                    - {name: SAMPLE_BOOKLET3.XML, size: 1284, modificationTime: 1615970109, type: Booklet, id: BOOKLET.SAMPLE-3, report: [], info: {description: "\n      This booklet has the same species as sample Booklet 1. The term booklet species indicates that both booklets can\n      be controlled by the group-monitor as if they where the same.\n      The species is currently defined as having the same number of testlets on the first level (called blocks). This\n      definition may change later.", label: 'Similar Booklet to Sample 1', totalSize: 60759}}
                                Testtakers:
                                    - {name: SAMPLE_TESTTAKERS.XML, size: 2180, modificationTime: 1615970109, type: Testtakers, id: SAMPLE_TESTTAKERS.XML, report: [], info: {description: 'This file contains some logins for testing and works a a sample for developers.', testtakers: 10}}
                                SysCheck:
                                    - {name: SAMPLE_SYSCHECK.XML, size: 1239, modificationTime: 1615970109, type: SysCheck, id: SYSCHECK.SAMPLE, report: [], info: {description: 'An example SysCheck definition with long description', label: 'An example SysCheck definition'}}
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '404':
                    description: 'Workspace not found'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
        delete:
            summary: 'delete files'
            description: 'deletes files from a workspace'
            tags:
                - 'admin workspace'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role "RW" (read/write) for this workspace'
                    example: 'a:user000000000.rw00000000'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                f:
                                    type: array
                                    description: 'array of file names'
                                    items: {type: string}
                        example:
                            f:
                                - SysCheck/SAMPLE_SYSCHECK.XML
                                - Unit/SAMPLE_UNIT.XML
                                - 'some rubbish'
                                - a/b
                                - ../../README.md
            responses:
                '207':
                    description: 'OK, a list of files'
                    content:
                        application/json:
                            example:
                                deleted:
                                    - SysCheck/SAMPLE_SYSCHECK.XML
                                did_not_exist:
                                    - 'some rubbish'
                                    - a/b
                                not_allowed:
                                    - ../../README.md
                                was_used:
                                    - Unit/SAMPLE_UNIT.XML
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '404':
                    description: 'Workspace not found'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    /workspace:
        put:
            summary: 'add a workspace'
            description: 'adds a workspace with given name'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                name:
                                    type: string
                                    description: 'workspace name'
                            required:
                                - name
                        example:
                            name: 'new work space'
            responses:
                '201':
                    description: 'OK, workspace has been added'
                '401':
                    description: 'Not authenticated'
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}':
        get:
            summary: 'get workspace'
            description: 'returns basic information about a workspace'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            responses:
                '200':
                    description: 'OK, workspace info'
                    content:
                        application/json:
                            example:
                                id: 1
                                name: example_workspace
                                role: RW
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
        patch:
            summary: 'rename a workspace'
            description: 'renames a workspace with given id'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                name:
                                    type: string
                                    description: Password
                            required:
                                - n
                        example:
                            name: 'a new york space'
            responses:
                '200':
                    description: 'OK, workspace has been renamed'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/users':
        patch:
            summary: 'change user roles'
            description: 'changes user roles in given workspaces'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                u:
                                    type: array
                                    description: 'array of pairs role-id'
                                    items: {type: object, properties: {id: {type: integer, description: user-id}, role: {type: string, description: 'role: ''RW'', ''MO'' or ''RO'''}}}
                            required:
                                - u
                        example:
                            u:
                                -
                                    role: RW
                                    id: 1
            responses:
                '200':
                    description: 'OK, roles has been updated'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
        get:
            summary: 'get a list of users in a workspace'
            description: 'returns info about all registered users in a workspace.'
            tags:
                - 'super admin'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with super-admin privilege'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            responses:
                '200':
                    description: 'List of users'
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/user_list'
                            example:
                                -
                                    name: super
                                    id: '1'
                                    selected: true
                                    role: RW
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/report/log':
        get:
            summary: 'get report of logs'
            description: 'returns a Log report in JSON or CSV format based on aggregated unit and booklet log data'
            tags:
                - 'admin download'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: query
                    name: dataIds
                    description: 'a comma separated list of report data-ids'
                    schema:
                        type: array
                        items:
                            type: string
                    example:
                        - review_group
                        - sample_group
            responses:
                '200':
                    description: 'Log report in JSON or CSV format based on aggregated unit and booklet log data.'
                    content:
                        text/csv;charset=UTF-8:
                            schema:
                                type: string
                            example: "groupname;loginname;code;bookletname;unitname;timestamp;logentry\n\"sample_group\";\"test\";\"xxx\";\"BOOKLET.SAMPLE-1\";\"UNIT.SAMPLE\";\"1627545600\";sample unit log\n\"sample_group\";\"test\";\"xxx\";\"BOOKLET.SAMPLE-1\";\"\";\"1627545600\";sample log entry"
                        application/json:
                            schema:
                                $ref: '#/components/schemas/LogReport'
                            example:
                                -
                                    groupname: sample_group
                                    loginname: test
                                    code: xxx
                                    bookletname: BOOKLET.SAMPLE-1
                                    unitname: UNIT.SAMPLE
                                    timestamp: '1627545600'
                                    logentry: 'sample unit log'
                                -
                                    groupname: sample_group
                                    loginname: test
                                    code: xxx
                                    bookletname: BOOKLET.SAMPLE-1
                                    unitname: ""
                                    timestamp: '1627545600'
                                    logentry: 'sample log entry'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/report/response':
        get:
            summary: 'get report of item responses'
            description: 'returns a Item Responses report in JSON or CSV format based on aggregated report data'
            tags:
                - 'admin download'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: query
                    name: dataIds
                    description: 'a comma separated list of report data-ids'
                    schema:
                        type: array
                        items:
                            type: string
                    example:
                        - review_group
                        - sample_group
            responses:
                '200':
                    description: 'Item Responses report in JSON or CSV format based on aggregated response data.'
                    content:
                        text/csv;charset=UTF-8:
                            schema:
                                type: string
                            example: "groupname;loginname;code;bookletname;unitname;responses;laststate\n\"sample_group\";\"test\";\"xxx\";\"BOOKLET.SAMPLE-1\";\"UNIT.SAMPLE\";\"[{\"\"id\"\":\"\"all\"\",\"\"content\"\":\"\"{\\\"\"name\\\"\":\\\"\"Sam Sample\\\"\",\\\"\"age\\\"\":34}\"\",\"\"ts\"\":1627545600,\"\"responseType\"\":\"\"example-data-format\"\"}]\";\"{\"\"PRESENTATIONCOMPLETE\"\":\"\"yes\"\"}\""
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ResponseReport'
                            example:
                                -
                                    groupname: sample_group
                                    loginname: test
                                    code: xxx
                                    bookletname: BOOKLET.SAMPLE-1
                                    unitname: UNIT.SAMPLE
                                    responses: [{id: all, content: '{"name":"Sam Sample","age":34}', ts: 1627545600, responseType: example-data-format}]
                                    laststate: '{"PRESENTATIONCOMPLETE":"yes"}'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/report/review':
        get:
            summary: 'get report of item reviews'
            description: 'returns a Review report in JSON or CSV format based on aggregated unit and booklet review data'
            tags:
                - 'admin download'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: query
                    name: dataIds
                    description: 'a comma separated list of report data-ids'
                    schema:
                        type: array
                        items:
                            type: string
                    example:
                        - review_group
                        - sample_group
            responses:
                '200':
                    description: 'Reviews report in JSON or CSV format based on aggregated unit and booklet review data.'
                    content:
                        text/csv;charset=UTF-8:
                            schema:
                                type: string
                            example: "groupname;loginname;code;bookletname;unitname;priority;reviewtime;entry\n\"sample_group\";\"test\";\"xxx\";\"BOOKLET.SAMPLE-1\";\"UNIT.SAMPLE\";\"1\";\"2021-07-29 10:00:00\";\"this is a sample unit review\"\n\"sample_group\";\"test\";\"xxx\";\"BOOKLET.SAMPLE-1\";\"\";\"1\";\"2021-07-29 10:00:00\";\"sample booklet review\""
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ReviewReport'
                            example:
                                -
                                    groupname: sample_group
                                    loginname: test
                                    code: xxx
                                    bookletname: BOOKLET.SAMPLE-1
                                    unitname: UNIT.SAMPLE
                                    priority: '1'
                                    reviewtime: '2021-07-29 10:00:00'
                                    entry: 'this is a sample unit review'
                                -
                                    groupname: sample_group
                                    loginname: test
                                    code: xxx
                                    bookletname: BOOKLET.SAMPLE-1
                                    unitname: ""
                                    priority: '1'
                                    reviewtime: '2021-07-29 10:00:00'
                                    entry: 'sample booklet review'
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/report/sys-check':
        get:
            summary: 'get report of system checks'
            description: 'returns a System Check report in JSON or CSV format based on aggregated report data'
            tags:
                - 'admin download'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: query
                    name: dataIds
                    description: 'a comma separated list of report data-ids'
                    schema:
                        type: array
                        items:
                            type: string
                    example:
                        - SYSCHECK.SAMPLE
            responses:
                '200':
                    description: 'System Checks report in JSON or CSV format based on aggregated system check data.'
                    content:
                        text/csv;charset=UTF-8:
                            schema:
                                type: string
                            example: "\"Titel\";\"SysCheck-Id\";\"SysCheck\";\"DatumTS\";\"Datum\";\"FileName\";\"Betriebsystem\";\"Betriebsystem-Version\";\"Bildschirm-Auflösung\";\"Browser\";\"Browser-Cookies aktiviert\";\"Browser-Plugins:\";\"Browser-Sprache\";\"Browser-Version\";\"CPU-Architektur\";\"CPU-Kerne\";\"Fenster-Größe\";\"Downloadgeschwindigkeit\";\"Downloadgeschwindigkeit benötigt\";\"Downloadbewertung\";\"Uploadgeschwindigkeit\";\"Uploadgeschwindigkeit benötigt\";\"Uploadbewertung\";\"Gesamtbewertung\";\"RoundTrip in Ms\";\"Netzwerktyp nach Leistung\";\"Downlink MB/s\";\"Name\";\"Who am I?\";\"Why so serious?\";\"Check this out\";\"All we here is\";\"loading time\"\n\"SAMPLE SYS-CHECK REPORT\";\"SYSCHECK.SAMPLE\";\"An example SysCheck definition\";\"1627545600\";\"2021-07-29 10:00:00\";\"SAMPLE_SYSCHECK-REPORT.JSON\";\"Linux\";\"x86_64\";\"1680 x 1050\";\"Chrome\";\"1\";\"Chromium PDF Plugin, Chromium PDF Viewer\";\"en-US\";\"79\";\"amd64\";\"8\";\"1680 x 914\";\"75.72 Mbit/s\";\"8.19 kbit/s\";\"good\";\"2.84 Mbit/s\";\"8.19 kbit/s\";\"good\";\"good\";\"100\";\"4g\";\"1.45\";\"Sam Sample\";\"Harvy Dent\";\"Because.\";\"1\";\"Radio Gaga\";\"1594.295166015625\""
                        application/json:
                            schema:
                                $ref: '#/components/schemas/SysCheckReport'
                            example:
                                -
                                    date: '2020-02-17 13:01:31'
                                    checkId: SYSCHECK.SAMPLE
                                    checkLabel: 'An example SysCheck definition'
                                    title: 'SAMPLE SYS-CHECK REPORT'
                                    environment: [{id: '0', type: environment, label: Betriebsystem, value: Linux, warning: false}, {id: '0', type: environment, label: Betriebsystem-Version, value: x86_64, warning: false}, {id: '0', type: environment, label: Bildschirm-Auflösung, value: '1680 x 1050', warning: false}, {id: '0', type: environment, label: Browser, value: Chrome, warning: false}, {id: '0', type: environment, label: 'Browser-Cookies aktiviert', value: true, warning: false}, {id: '0', type: environment, label: 'Browser-Plugins:', value: 'Chromium PDF Plugin, Chromium PDF Viewer', warning: false}, {id: '0', type: environment, label: Browser-Sprache, value: en-US, warning: false}, {id: '0', type: environment, label: Browser-Version, value: '79', warning: false}, {id: '0', type: environment, label: CPU-Architektur, value: amd64, warning: false}, {id: '0', type: environment, label: CPU-Kerne, value: 8, warning: false}, {id: '0', type: environment, label: Fenster-Größe, value: '1680 x 914', warning: false}]
                                    network: [{id: '0', type: network, label: Downloadgeschwindigkeit, value: '75.72 Mbit/s', warning: false}, {id: '0', type: network, label: 'Downloadgeschwindigkeit benötigt', value: '8.19 kbit/s', warning: false}, {id: '0', type: network, label: Downloadbewertung, value: good, warning: false}, {id: '0', type: network, label: Uploadgeschwindigkeit, value: '2.84 Mbit/s', warning: false}, {id: '0', type: network, label: 'Uploadgeschwindigkeit benötigt', value: '8.19 kbit/s', warning: false}, {id: '0', type: network, label: Uploadbewertung, value: good, warning: false}, {id: '0', type: network, label: Gesamtbewertung, value: good, warning: false}, {id: '0', type: network, label: 'RoundTrip in Ms', warning: false, value: '100'}, {id: '0', type: network, label: 'Netzwerktyp nach Leistung', warning: false, value: 4g}, {id: '0', type: network, label: 'Downlink MB/s', warning: false, value: '1.45'}]
                                    questionnaire: [{id: '2', type: string, label: Name, value: 'Sam Sample', warning: false}, {id: '3', type: select, label: 'Who am I?', value: 'Harvy Dent', warning: false}, {id: '4', type: text, label: 'Why so serious?', value: Because., warning: false}, {id: '5', type: check, label: 'Check this out', value: true, warning: false}, {id: '6', type: radio, label: 'All we here is', value: 'Radio Gaga', warning: false}]
                                    unit: [{id: '0', type: unit/player, label: 'loading time', value: '1594.295166015625', warning: false}]
                                    fileData: [{id: date, label: DatumTS, value: '1627545600'}, {id: datestr, label: Datum, value: '2021-07-29 10:00:00'}, {id: filename, label: FileName, value: SAMPLE_SYSCHECK-REPORT.JSON}]
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/sys-check/reports':
        delete:
            summary: 'delete system check reports'
            description: 'deletes some System Check reports'
            tags:
                - 'admin workspace'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role "RW" (read/write) for this workspace'
                    example: 'a:user000000000.rw00000000'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            requestBody:
                content:
                    application/json:
                        schema:
                            properties:
                                checkIds:
                                    type: array
                                    description: 'array of sys-check-Ids'
                                    items: {type: string}
                            required:
                                - checkIds
                        example:
                            checkIds:
                                - SYSCHECK.SAMPLE
            responses:
                '207':
                    description: 'OK, a list of deleted files'
                    content:
                        application/json:
                            example:
                                deleted:
                                    - SysCheck/SAMPLE_SYSCHECK.XML
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/sys-check/reports/overview':
        get:
            summary: 'get a list of all system check reports'
            description: 'returns a list of all sys-check-reports with most important features grouped by the sys-checks.'
            tags:
                - 'admin workspace'
            parameters:
                -
                    in: header
                    name: AuthToken
                    description: 'auth-token for admin-user with role at least "RO" (read only) for this workspace'
                    example: 'a:user000000000.superadmin0'
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
            responses:
                '200':
                    description: 'List of digests of Sys-Check-Reports'
                    content:
                        application/json:
                            schema:
                                type: array
                                items:
                                    type: object
                                    description: 'aggregations of sys-check-reports to a specific report'
                                    properties: {id: {type: string, description: 'id of the *SysCheck* to which theese reports belongs'}, count: {type: number, description: 'number of aggregated sys-check-reports'}, label: {type: string, description: 'label of the SysCheck'}, details: {type: object, description: 'assoc containing statistics over most important report-fields in the form feature - nummer of occurances'}}
                            example:
                                -
                                    id: SYSCHECK.SAMPLE
                                    count: 1
                                    label: 'An example SysCheck definition'
                                    details: {os: {'Linux x86_64': 1}, browser: {'Chrome 79': 1}}
                '401':
                    description: 'Not authenticated'
                '403':
                    description: Forbidden
                '410':
                    description: 'Session Expired'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/sys-check/{sys_check_name}':
        get:
            summary: 'get system check configuration'
            description: 'returns a specific SysCheck configuation **this endpoint does not need any authetication!**'
            tags:
                - 'session management'
            parameters:
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: path
                    name: sys_check_name
                    description: 'name of the SysCheck (as stored in the XML)'
                    example: SYSCHECK.SAMPLE
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'Configuation of a SysCheck (as JSON, not as plain XML)'
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/sys_check'
                '404':
                    description: 'No SysCheck with that name found on Workspace'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/sys-check/{sys_check_name}/unit-and-player':
        get:
            summary: 'get system check Unit and Player'
            description: 'returns a container with the unit and it''s player according to a SysCheck'
            tags:
                - 'run system check'
            parameters:
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: path
                    name: sys_check_name
                    description: 'name of the SysCheck (as stored in the XML)'
                    example: SYSCHECK.SAMPLE
                    required: true
                    schema:
                        type: string
            responses:
                '200':
                    description: 'A container with the unit and it''s player'
                '404':
                    description: 'No SysCheck with that name found on Workspace'
                '500':
                    description: 'Server Error'
    '/workspace/{ws_id}/sys-check/{sys_check_name}/report':
        put:
            summary: 'save system check'
            description: 'save the results of a performed SysCheck'
            tags:
                - 'run system check'
            parameters:
                -
                    in: path
                    name: ws_id
                    description: workspace-id
                    example: 1
                    required: true
                    schema:
                        type: integer
                -
                    in: path
                    name: sys_check_name
                    description: 'name of the SysCheck (as stored in the XML)'
                    example: SYSCHECK.SAMPLE
                    required: true
                    schema:
                        type: string
            requestBody:
                content:
                    application/json:
                        example:
                            keyPhrase: saveme
                            title: dsk
                            environment:
                                -
                                    id: '0'
                                    type: environment
                                    label: Betriebsystem
                                    value: Linux
                                    warning: false
                                -
                                    id: '0'
                                    type: network
                                    label: Downloadgeschwindigkeit
                                    value: '68.01 Mbit/s'
                                    warning: false
                            questionnaire: []
                            unit:
                                -
                                    id: '0'
                                    type: unit/player
                                    label: 'loading time'
                                    value: '27'
                                    warning: false
            responses:
                '201':
                    description: 'Ok, Report saved'
                '404':
                    description: 'No SysCheck with that name found on Workspace'
                '500':
                    description: 'Server Error'
components:
    schemas:
        auth:
            type: object
            properties:
                at:
                    type: string
                    description: 'authtoken für admin and maybe super admin modules'
                    example: user000000000.superadmin0
            required:
                - at
        auth_test:
            type: object
            properties:
                p:
                    type: string
                    description: 'authtoken für test module - person'
                    example: person00000000.test0000000
                l:
                    type: string
                    description: 'authtoken für test module - login'
                    example: person00000000.test0000000
            required:
                - l
        login_request:
            type: object
            properties:
                name:
                    type: string
                    description: Username
                    example: super
                password:
                    type: string
                    description: Password
                    example: user123
        session:
            description: 'content of a session'
            type: object
            properties:
                token:
                    type: string
                    description: 'Token for session authentication'
                    example: person00000000.test0000000
                displayName:
                    type: string
                    description: 'name to be displayed'
                    example: super
                customTexts:
                    type: object
                    description: 'An Object containing customtext-strings for the UI as key-value-pairs'
                    example:
                        somestr: string
                flags:
                    type: array
                    description: "flags with additional information.\n  * `codeRequired` that indicates that a second part of authentication is required"
                access:
                    description: 'A collection of available obejcts. The keys are type of object.'
                    type: object
                    properties:
                        workspaceAdmin:
                            type: string
                            description: 'Elements are (numeric) Workspace-Ids. Use `[GET] /workspace/{worksapce_id}` to obtain label, user-rights and such.'
                        superAdmin:
                            type: string
                            description: 'No Elements. Presence of this key indicates access to Superadmin-functions for this user.'
                        test:
                            type: string
                            description: 'Elements are booklet-names (not test-ids because unstarted tests don''t have one. Through the endpoint `[GET] /booklet/{test_name}` the corresponding ids, and if startet, status etc. can be obtained.'
                        testGroupMonitor:
                            type: string
                            description: workspace(s)
        workspace:
            type: object
            properties:
                id:
                    type: string
                    example: '1'
                name:
                    type: string
                    example: example_workspace
                role:
                    type: string
                    example: RW
                selected:
                    type: boolean
                    example: false
                    description: 'TODO what does this do?'
            required:
                - id
        workspace_list:
            type: array
            description: 'List of Workspaces'
            items:
                $ref: '#/components/schemas/workspace'
        user_list:
            type: array
            description: 'List of Users'
            items:
                $ref: '#/components/schemas/user'
        user:
            type: object
            description: 'a user'
            properties:
                name:
                    type: string
                    example: super
                id:
                    type: string
                    example: '1'
                email:
                    type: string
                    nullable: true
                    example: null
                isSuperadmin:
                    type: boolean
                    example: true
                selected:
                    type: boolean
                    example: true
                    description: 'TODO what does this do?'
                role:
                    type: string
                    example: RW
            required:
                - id
                - name
        file:
            type: object
            description: 'information about a file'
            properties:
                filename:
                    type: string
                filesize:
                    type: integer
                    description: 'file size in byte'
                filesizestr:
                    type: string
                    description: 'human readable filesize'
                filedatetime:
                    type: integer
                    description: 'modification date as unix time stamp'
                filedatetimestr:
                    type: string
                    description: 'modification date as human readable string'
                type:
                    type: string
                    description: 'Testtakers | Booklet | Resource | Unit | SysCheck'
                typelabel:
                    type: string
                    description: 'Testtakers | Booklet | Resource | Unit | SysCheck'
        file_list:
            type: array
            description: 'List of Files'
            items:
                $ref: '#/components/schemas/file'
        sys_check:
            type: object
            description: 'Configuration of a SysCheck'
            properties:
                name:
                    description: 'name of the SysCheck as defiend in the XML-file'
                    type: string
                label:
                    description: 'label to display'
                    type: string
                questions:
                    description: 'set of questions for the questionaire'
                    type: array
                    items:
                        $ref: '#/components/schemas/question_def'
                hasUnit:
                    description: 'is there a unit for this SysCheck?'
                    type: boolean
                canSave:
                    description: 'is saving SysCheck-Report allowed?'
                    type: boolean
                customTexts:
                    description: CustomTexts
                    type: object
                skipNetwork:
                    description: 'skip the network test?'
                    type: boolean
                downloadSpeed:
                    $ref: '#/components/schemas/speed_params'
                uploadSpeed:
                    $ref: '#/components/schemas/speed_params'
                workspaceId:
                    description: 'on which workspace is this SysCheck?'
                    type: number
        speed_params:
            type: object
            description: 'paramaters of a speed-check'
            properties:
                min:
                    description: 'minimal speed to get a `sufficient` rating in **Bytes per second**'
                    type: number
                    example: 1875000
                good:
                    description: 'minimal speed to get a `good` rating in **Bytes per second**'
                    type: number
                    example: 3750000
                maxDevianceBytesPerSecond:
                    description: 'maximal deviance allowed to pass one round of regeression test in **Bytes per second**'
                    type: number
                    example: 100000
                maxErrorsPerSequence:
                    description: 'allow this number of errors in one sequence and still pass, normally 0'
                    type: integer
                    example: 0
                maxSequenceRepetitions:
                    description: 'how many test sequences should be run (if they exceedmax deviance), minimum is 3'
                    type: integer
                    example: 15
                sequenceSizes:
                    description: 'array of numbers describing the packagae sized for each sequence'
                    type: array
                    items:
                        type: integer
                    example:
                        - 400000
                        - 800000
                        - 1600000
                        - 3200000
        question_def:
            type: object
            description: 'definition of a SysCheck-questionaire'
            properties:
                id:
                    type: number
                    description: 'identifier of the question'
                    example: 1
                type:
                    description: 'type of the questions, like ''header'', ''string'', ''select'', ''text'', ''check'', ''radio'''
                    type: string
                    example: select
                prompt:
                    description: 'Question text'
                    type: string
                    example: 'What is the capital of Switzerland?'
                options:
                    description: 'list of options for type `check` or `select`'
                    type: array
                    items:
                        type: string
                    example:
                        - Bern
                        - Zurich
                required:
                    description: 'is this question required'
                    type: boolean
                    example: false
        state:
            type: array
            description: 'An array of state-items.'
            items:
                $ref: '#/components/schemas/state_item'
        state_item:
            type: object
            description: 'Represents a certain entry in the state. Every key-value pair can be taken. For more about test and unit states'
            properties:
                key:
                    type: string
                    example: STATE_KEY
                    description: 'The key of this state'
                content:
                    type: string
                    example: STATE_VALUE
                    description: 'The value of this state. For logs this is optional, since a log can be only a single string.'
                timeStamp:
                    type: number
                    example: 123456798
                    description: 'Because every state change gets logged a timestamp is necessary'
            required:
                - key
                - content
                - timeStamp
        log_set:
            type: array
            description: 'An array of state-items.'
            items:
                $ref: '#/components/schemas/log_set_item'
        log_set_item:
            type: object
            description: 'Represents a certain entry in the state. Every key-value pair can be taken. For more about test and unit states'
            properties:
                key:
                    type: string
                    example: STATE_KEY
                    description: 'The key of this state'
                content:
                    type: string
                    example: STATE_VALUE
                    description: 'The value of this state. For logs this is optional, since a log can be only a single string.'
                timeStamp:
                    type: number
                    example: 123456798
                    description: 'Because every state change gets logged a timestamp is necessary'
            required:
                - key
                - timeStamp
        LogReport:
            type: array
            items:
                type: object
                properties:
                    groupname:
                        type: string
                    loginname:
                        type: string
                    code:
                        type: string
                        description: 'person code'
                    bookletname:
                        type: string
                    unitname:
                        type: string
                    timestamp:
                        type: string
                    logentry:
                        type: string
        ResponseReport:
            type: array
            items:
                type: object
                properties:
                    groupname:
                        type: string
                    loginname:
                        type: string
                    code:
                        type: string
                        description: 'person code'
                    bookletname:
                        type: string
                    unitname:
                        type: string
                    responses:
                        type: string
                    restorePoint:
                        type: string
                    responseType:
                        type: string
                    response-ts:
                        type: string
                    restorePoint-ts:
                        type: string
                    laststate:
                        type: string
        ReviewReport:
            type: array
            items:
                type: object
                properties:
                    groupname:
                        type: string
                    loginname:
                        type: string
                    code:
                        type: string
                        description: 'person code'
                    bookletname:
                        type: string
                    unitname:
                        type: string
                    priority:
                        type: string
                    reviewtime:
                        type: string
                        format: date-time
                    entry:
                        type: string
        CommonSysCheckReportSection:
            type: array
            items:
                type: object
                properties:
                    id:
                        type: string
                    type:
                        type: string
                    label:
                        type: string
                    value:
                        type: string
                    warning:
                        type: boolean
        SysCheckReport:
            type: array
            description: 'an array of system check reports'
            items:
                type: object
                properties:
                    date:
                        type: string
                        format: date-time
                    checkId:
                        type: string
                    checkLabel:
                        type: string
                    title:
                        type: string
                    environment:
                        $ref: '#/components/schemas/CommonSysCheckReportSection'
                    network:
                        $ref: '#/components/schemas/CommonSysCheckReportSection'
                    questionnaire:
                        $ref: '#/components/schemas/CommonSysCheckReportSection'
                    unit:
                        $ref: '#/components/schemas/CommonSysCheckReportSection'
                    fileData:
                        type: array
                        items:
                            type: object
                            properties:
                                id:
                                    type: string
                                label:
                                    type: string
                                value:
                                    type: string
